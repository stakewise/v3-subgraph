specVersion: 0.0.4
description: The liquid staking protocol
repository: https://github.com/stakewise/v3-subgraph
schema:
  file: ./schema.graphql
features:
  - ipfsOnEthereumContracts
dataSources:
  - kind: ethereum/contract
    name: VaultFactory
    network: {{ network }}
    source:
      address: '{{ vaultFactory.address }}'
      abi: VaultFactory
      startBlock: {{ vaultFactory.startBlock }}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      file: ./mappings/vaultFactory.ts
      entities:
        - Vault
        - Network
      abis:
        - name: VaultFactory
          file: ./abis/VaultFactory.json
      eventHandlers:
        - event: VaultCreated(indexed address,indexed address,indexed address,uint256,uint16,string,string)
          handler: handleVaultCreated
templates:
  - kind: ethereum/contract
    name: Vault
    network: {{ network }}
    source:
      abi: Vault
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      file: ./mappings/vault.ts
      entities:
        - Vault
        - Allocator
        - ExitRequest
        - DaySnapshot
        - AllocatorAction
      abis:
        - name: Vault
          file: ./abis/Vault.json
        - name: Multicall
          file: ./abis/Multicall.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
        - event: StateUpdated(int256)
          handler: handleStateUpdated
        - event: ExitQueueEntered(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleExitQueueEntered
        - event: ExitedAssetsClaimed(indexed address,indexed address,indexed uint256,uint256,uint256)
          handler: handleExitedAssetsClaimed
        - event: ValidatorsRootUpdated(indexed bytes32,string)
          handler: handleValidatorsRootUpdated
        - event: MetadataUpdated(string)
          handler: handleMetadataUpdated
      blockHandlers:
        - handler: handleBlock
  - kind: ethereum/contract
    name: ExitQueue
    network: {{ network }}
    source:
      abi: ExitQueue
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      file: ./mappings/exitQueue.ts
      entities:
        - VaultCheckpoint
        - DaySnapshot
      abis:
        - name: ExitQueue
          file: ./abis/ExitQueue.json
      eventHandlers:
        - event: CheckpointCreated(uint160,uint96)
          handler: handleCheckpointCreated
  - kind: ethereum/contract
    name: MevEscrow
    network: {{ network }}
    source:
      abi: MevEscrow
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      file: ./mappings/mevEscrow.ts
      entities:
        - Vault
        - DaySnapshot
      abis:
        - name: MevEscrow
          file: ./abis/MevEscrow.json
      eventHandlers:
        - event: MevReceived(uint256)
          handler: handleMevReceived
  - kind: ethereum/contract
    name: Keeper
    network: {{ network }}
    source:
      abi: Keeper
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      file: ./mappings/keeper.ts
      entities:
        - Vault
        - DaySnapshot
      abis:
        - name: Keeper
          file: ./abis/Keeper.json
      eventHandlers:
        - event: RewardsRootUpdated(indexed address,indexed bytes32,uint64,uint96,string)
          handler: handleRewardsRootUpdated
